<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Levels Academy – Courses Plugin</title>

<!-- Red Hat Display (variable) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">

<style>
:root{
  --bg: transparent;   /* page background is transparent behind the frame */
  --card:#aee2d7;      /* card green */
  --text:#10201a;
  --muted:#2b3c34;     /* kept but overridden below where needed */
  --shadow: 0 18px 30px rgba(0,0,0,.08);
  --chip:#23B899;      /* not used for pills anymore, but kept for other accents */
  --title-size:24px;   /* base for course title + price on desktop */
  --brand-dark:#2B445B;
}

/* Reset */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow-x:hidden}
body{
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}

/* Frame container */
.wrap{
  max-width:100%;
  margin:28px 0;
  background:#ffffff;            /* bottom stays white */
  border-radius:20px;
  overflow:hidden;               /* keeps rounded corners for both parts */
}

/* Top section (behind main tabs + subtabs) */
.wrap-header{
  background:#2B445B;
  padding:25px 20px;
}

/* Bottom section (cards area) — top padding EXACTLY 20px */
.wrap-content{
  background:#ffffff;
  padding:20px 20px 25px;        /* top=20px */
}

/* Main tabs (already set previously as text-only) */
.tabbar{
  display:flex;
  gap:20px;
  justify-content:center;
  margin-bottom:22px;
  max-width:calc(4 * 200px + 3 * 14px);
  margin-left:auto;margin-right:auto;
}
.main-tab{
  flex:1;
  text-align:center;

  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:800;               /* ExtraBold */
  font-size:32px;                /* desktop */
  line-height:1.1;

  background:transparent;
  color:#ffffff;                 /* default text = white */
  border:0;
  border-radius:0;
  padding:10px 0;
  cursor:pointer;
  transition:color .2s ease, opacity .2s ease;
  box-shadow:none;
}
.main-tab[aria-selected="true"]{ color:#ADE2D7; }
.main-tab:hover{opacity:.95}

/* Subtabs — FONT + SIZES ONLY; behavior unchanged */
.subtabs{
  display:flex;gap:14px;flex-wrap:wrap;justify-content:center;margin-bottom:22px
}
.subtab-btn{
  flex:0 1 200px;max-width:200px;text-align:center;padding:10px 0;border-radius:999px;
  border:0;cursor:pointer;background:#fff;box-shadow:var(--shadow);

  /* New font + sizes */
  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:400;               /* Regular */
  font-size:18px;                /* desktop */
  transition:transform .15s ease,background .2s ease
}
.subtab-btn[aria-selected="true"]{background:var(--card)}
.subtab-btn:hover{transform:scale(1.02)}

/* Grid + Cards */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(420px,1fr));
  gap:24px;
}
.card{
  background:var(--card);
  border-radius:28px;
  padding:30px;
  box-shadow:var(--shadow);
  position:relative;
  display:flex;
  flex-direction:column;
  min-height:380px;
  transition:transform .2s ease;
}
.card:hover{transform:translateY(-2px) scale(1.01)}

/* Icon row: two icons, no background */
.icon-row{display:flex;gap:10px;margin-bottom:10px;align-items:center}
.icon{width:32px;height:32px;display:inline-block;flex:0 0 auto;pointer-events:none;
  transform:translate3d(0,0,0);filter:blur(0px);opacity:1;transition:filter .18s linear, opacity .18s linear}
.icon img{width:100%;height:100%;display:block;object-fit:contain;background:transparent!important}
/* Only the right icon animates */
.icon.anim{will-change:transform, filter, opacity}

/* Title → Red Hat Display ExtraBold, 24/22/20; color brand dark */
.title{
  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:800;               /* ExtraBold */
  font-size:24px;                /* desktop */
  line-height:1.2;
  margin:4px 0 6px;
  color:var(--brand-dark);
}

/* Age line → Regular Italic, 16/14/12; color brand dark */
.age-text{
  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-style:italic;
  font-weight:400;               /* Regular */
  font-size:16px;                /* desktop */
  color:var(--brand-dark);
  margin-bottom:12px;
}

/* Description → Light, 18/16/12; color brand dark (as per “all dark text”) */
.desc{
  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:300;               /* Light */
  font-size:18px;                /* desktop */
  color:var(--brand-dark);
  margin:16px 0 18px;
  line-height:1.5;
  word-break:break-word;
  hyphens:auto;
}

/* Chips → Regular 16/14/12; pill color #2B445B, text white */
.chips{
  display:flex;
  flex-wrap:wrap;
  gap:14px;
  margin-top:auto;
}
.chip{
  background:#2B445B;           /* pill color */
  color:#fff;                    /* keep text white */
  border-radius:28px;
  padding:8px 12px;

  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:400;               /* Regular */
  font-size:16px;                /* desktop */

  flex:1 1 calc(33.333% - 14px);
  text-align:center;
  box-shadow:var(--shadow);
  white-space:nowrap;
}

/* Price → same size as title; color brand dark */
.price{
  display:block;
  text-align:right;
  margin-top:18px;

  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:800;               /* match title weight for parity */
  font-size:24px;                /* desktop matches title */
  color:var(--brand-dark);
}
.per{
  font-family:"Red Hat Display", sans-serif;
  font-optical-sizing:auto;
  font-weight:700;               /* keep bold look for per-label */
  font-size:14px;                /* unchanged per request */
  color:var(--brand-dark);
  margin-left:6px;
}

/* Hidden + overlay */
.hidden{display:none !important}
.card .card-overlay{
  position:absolute;inset:0;border-radius:28px;display:block;text-decoration:none;z-index:5
}
.card .card-overlay:focus{outline:none}

/* Tablet */
@media (min-width:641px) and (max-width:1024px){
  .grid{grid-template-columns:repeat(2, minmax(0, 1fr));gap:22px}
  .card{min-height:440px}

  /* main tabs from earlier step */
  .main-tab{font-size:24px}

  /* Subtabs size = 16 */
  .subtab-btn{font-size:16px}

  /* Title 22, Age 14, Desc 16, Price 22, Chip 14 */
  .title{font-size:22px}
  .age-text{font-size:14px}
  .desc{font-size:16px}
  .price{font-size:22px}
  .chip{font-size:14px}
}

/* Mobile */
@media (max-width:640px){
  .wrap{border-radius:9px}
  .wrap-header{padding:15px 10px}
  .wrap-content{padding:20px 10px 25px} /* keep top=20px on mobile too */

  .tabbar{flex-direction:column;max-width:none}
  .main-tab{
    width:100%;max-width:none;
    font-size:20px;             /* phone main tabs from earlier step */
    padding:14px 0;
  }

  /* Subtabs size = 16; and switch “dark” mobile text to brand dark */
  .subtabs{justify-content:space-between}
  .subtab-btn{
    flex:1 1 calc(50% - 7px);
    max-width:calc(50% - 7px);
    font-size:16px;
    color:var(--brand-dark);    /* replaces previous #000000 */
  }

  .grid{grid-template-columns:1fr}
  .card{padding:20px;min-height:auto}
  .desc{display:none}           /* keep original behavior: hide desc on phones */
  .chips{margin-top:8px}

  /* Title 20, Age 12, Price 20, Chip 12 */
  .title{font-size:20px}
  .age-text{font-size:12px}
  .price{font-size:20px}
  .chip{font-size:12px}
}

/* ---------- Tints (icons) ---------- */
/* Always neutralize to pure black first, then tint */
.icon img{filter:brightness(0) saturate(100%)}
.t-blue  img{filter:brightness(0) saturate(100%) invert(44%) sepia(23%) saturate(1471%) hue-rotate(185deg) brightness(92%) contrast(92%)}  /* ~ #3F85C6 */
.t-yellow img{filter:brightness(0) saturate(100%) invert(86%) sepia(49%) saturate(626%) hue-rotate(355deg) brightness(104%) contrast(96%)} /* ~ #F1E073 */
.t-teal img{filter:brightness(0) saturate(100%) invert(49%) sepia(78%) saturate(536%) hue-rotate(119deg) brightness(95%) contrast(88%)}   /* ~ #23B899 */
.t-dark  img{filter:brightness(0) saturate(100%) invert(16%) sepia(3%) saturate(12%) hue-rotate(314deg) brightness(91%) contrast(85%)}   /* ~ #333333 */
.t-red   img{filter:brightness(0) saturate(100%) invert(68%) sepia(22%) saturate(1196%) hue-rotate(307deg) brightness(97%) contrast(97%)}/* ~ #F66E6E */
.t-white img{filter:invert(100%)} /* #FFFFFF */
</style>
</head>
<body>
<div class="wrap" id="app">
  <div class="wrap-header">
    <div class="tabbar" role="tablist" aria-label="Course families">
      <button class="main-tab" id="tab-en" aria-selected="true">English Language Courses</button>
      <button class="main-tab" id="tab-art" aria-selected="false">Art Courses</button>
    </div>

    <div id="subtabs-en" class="subtabs" role="tablist">
      <button class="subtab-btn" id="sub-children" aria-selected="true">children</button>
      <button class="subtab-btn" id="sub-teenagers" aria-selected="false">teenagers</button>
      <button class="subtab-btn" id="sub-adults" aria-selected="false">adults</button>
      <button class="subtab-btn" id="sub-corporate" aria-selected="false">corporate</button>
    </div>
  </div>

  <div class="wrap-content">
    <section id="panel-en" role="tabpanel">
      <div id="subpanel-children" role="tabpanel"><div class="grid" data-grid="children"></div></div>
      <div id="subpanel-teenagers" role="tabpanel" class="hidden"><div class="grid" data-grid="teenagers"></div></div>
      <div id="subpanel-adults" role="tabpanel" class="hidden"><div class="grid" data-grid="adults"></div></div>
      <div id="subpanel-corporate" role="tabpanel" class="hidden"><div class="grid" data-grid="corporate"></div></div>
    </section>

    <section id="panel-art" role="tabpanel" class="hidden"><div class="grid" data-grid="art"></div></section>
  </div>
</div>

<script>
/* Helper text first */
function base(){
  return "This is the space to describe the service and explain how customers or clients can benefit from it. It’s an opportunity to add a short description that includes relevant details, like pricing, duration, location and how to book the service.";
}
function kidsdesc(){
  return "A fun and interactive English course for children aged 6–10, combining reading, writing, speaking, and listening skills with expert Georgian and native-speaking teachers.";
}
function ieltsdesc(){
  return "A comprehensive IELTS preparation course with mock exams and expert guidance to help you achieve your target score.";
}
function genteendesc(){
  return "Designed for learners aged 11–17, the program combines academic English training with dynamic speaking practice, preparing students for international exams and helping them communicate effectively in real-life situations.";
}
function privatedesc(){
  return "Learn at your own pace with flexible one-on-one lessons tailored to your goals, available both online and at the academy.";
}
function fcedesc(){
  return "This program prepares students for the Cambridge FCE, CAE, and PET exams through targeted training in reading, writing, listening, speaking, and grammar.";
}

const data = {
  children: [
    { title:"Sunday School",   age:"6 – 10 y.o.", desc:"Our Sunday School program offers children a fun and interactive way to learn English once a week. Lessons combine language skills with games, activities, and projects that make learning enjoyable while building confidence and communication skills.", chips:["10 months","43 sessions","86 hours"], price:"185", priceNote:"per month", link:"https://levelscenter.wixstudio.com/my-site/blank-4" },
    { title:"Saturday School", age:"6 – 10 y.o.", desc:"Saturday School provides children with intensive English practice in a friendly and engaging environment. With a mix of academic learning and interactive activities, students strengthen their reading, writing, speaking, and listening skills in just one day a week.", chips:["10 months","43 sessions","86 hours"], price:"185", priceNote:"per month", link:"https://levelscenter.wixstudio.com/my-site/blank-7" },
    { title:"General English", age:"6 – 10 y.o.", desc:"This program develops all core English skills—reading, writing, grammar, vocabulary, and speaking—through age-appropriate materials and activities. With guidance from Georgian and native-speaking teachers, children build a strong foundation in English and the confidence to use it in everyday situations.", chips:["10 months","43 sessions","86 hours"], price:"185", priceNote:"per month", link:"https://levelscenter.wixstudio.com/my-site/blank-2" },
  ],
  teenagers: [
    { title:"IELTS", age:"from 16 y.o.", desc:ieltsdesc(), chips:["5 weeks","15 sessions","30 hours"], price:"560", priceNote:"full course", link:"https://levelscenter.wixstudio.com/my-site/blank-10" },
    { title:"General English", age:"11 – 17 y.o.", desc:genteendesc(), chips:["4 months","48 sessions","72 hours"], price:"285", priceNote:"per month", link:"#teens-general" },
    { title:"Private Lessons", age:"from 11 y.o.", desc:privatedesc(), chips:["individual","tailored","schedule"], price:"ind.", priceNote:"tailored pricing", link:"#teens-private" },
    { title:"FCE   PET   CAE", age:"from 16 y.o.", desc:fcedesc(), chips:["5 weeks","10 sessions","15 hours"], price:"350", priceNote:"per month", link:"#teens-fce" },
  ],
  adults: [
    { title:"IELTS", age:"for adults", desc:ieltsdesc(), chips:["5 weeks","15 sessions","30 hours"], price:"560", priceNote:"full course", link:"#adults-ielts" },
    { title:"General English", age:"for adults", desc:"Designed for adult learners, the program combines academic English training with dynamic speaking practice, preparing students to communicate effectively in real-life situations.", chips:["4 months","48 sessions","72 hours"], price:"225", priceNote:"per month", link:"#adults-general" },
    { title:"Private Lessons", age:"for adults", desc:privatedesc(), chips:["individual","tailored","schedule"], price:"ind.", priceNote:"tailored pricing", link:"#adults-private" },
    { title:"Professional English", age:"for adults", desc:"The course is designed for you to develop proficiency and confidence in using English effectively and clearly across diverse professional and business settings.", chips:["4 months","48 sessions","96 hours"], price:"320", priceNote:"per month", link:"#adults-pro" },
    { title:"FCE   PET   CAE", age:"for adults", desc:fcedesc(), chips:["5 weeks","10 sessions","15 hours"], price:"350", priceNote:"per month", link:"#adults-fce" },
  ],
  corporate: [
    { title:"Corporate Courses", age:"for companies", desc:"Tailored courses for companies, government entities, and teams of all levels, delivered by experienced trainers through interactive lessons, real-world scenarios, and flexible learning formats.", chips:["individual","tailored","schedule"], price:"ind.", priceNote:"tailored pricing", link:"https://levelscenter.wixstudio.com/my-site/blank-6" },
  ],
  art: [
    { title:"Drawing & Painting", age:"7 – 15 y.o.", desc:"This program introduces children and teens to the fundamentals of drawing and painting, from composition and perspective to color and style, while encouraging creativity and self-expression.", chips:["twice a week","8 sessions","12 hours"], price:"160", priceNote:"per month", link:"#art-kids" },
    { title:"Drawing & Painting", age:"from 16 y.o.", desc:"This program helps adults master the fundamentals and techniques of drawing and painting while developing their own artistic style. Guided by professional artists.", chips:["twice a week","8 sessions","16 hours"], price:"160", priceNote:"per month", link:"#art-teen" },
    { title:"Portfolio Creation",  age:"from 16 y.o.", desc:"This program helps aspiring art students create a professional portfolio under the guidance of experienced artists and professors. Alongside portfolio preparation, students receive free admission support for our partner universities, including Istituto Marangoni and Nuova Accademia di Belle Arti (NABA).", chips:["individual","tailored","schedule"], price:"500", priceNote:"full course", link:"#art-portfolio" },
  ],
};
const currency = "₾";

/* Icon URLs */
const ICON_URLS = [
  "https://static.wixstatic.com/shapes/d67a12_08ba7d04bbfa4eb4846183d144607fc6.svg",
  "https://static.wixstatic.com/shapes/d67a12_040c94dfc68541a591e83deda47eb62f.svg",
  "https://static.wixstatic.com/shapes/d67a12_74b43991e42449909401bce92d8a2621.svg",
  "https://static.wixstatic.com/shapes/d67a12_68d6a2f87fd24e46b956dd4948936728.svg",
  "https://static.wixstatic.com/shapes/d67a12_57991b3e753648b3a695519407a01c1a.svg",
  "https://static.wixstatic.com/shapes/d67a12_255981ca0e25498187d18a8ed2cbacc2.svg",
  "https://static.wixstatic.com/shapes/d67a12_c9de44b3002d412ea00d70f440891cbb.svg",
  "https://static.wixstatic.com/shapes/d67a12_86b1b02733564e2c9077f9ee263984ee.svg",
  "https://static.wixstatic.com/shapes/d67a12_1d3f46a9d59249d79842477b1ec36e9e.svg",
  "https://static.wixstatic.com/shapes/d67a12_62e750d204fe42739dd23f531ac4b4f4.svg",
  "https://static.wixstatic.com/shapes/d67a12_eecc7354a15c40879ebb4d52c69ec10d.svg",
  "https://static.wixstatic.com/shapes/d67a12_d29181cff83b4d3db6c83b914a7f4a8e.svg",
  "https://static.wixstatic.com/shapes/d67a12_438f5aae79b6441691cfe6199eff0b3b.svg",
  "https://static.wixstatic.com/shapes/d67a12_8090e3ab006f42979be897df8ac54ba3.svg",
  "https://static.wixstatic.com/shapes/d67a12_cc6f51e05c3747bb83525a699f98bbff.svg",
  "https://static.wixstatic.com/shapes/d67a12_c5cebe3adf72471b8b12f66d72173a49.svg",
  "https://static.wixstatic.com/shapes/d67a12_097c4490809b417d9ad58aca69cd0afb.svg",
  "https://static.wixstatic.com/shapes/d67a12_2e0d63c7f1084d19966d8faf302a2e2f.svg",
  "https://static.wixstatic.com/shapes/d67a12_1dccc2c219c94a10aa5303a12d7cfc9d.svg",
  "https://static.wixstatic.com/shapes/d67a12_cc34244547fc40928fc03881a9a03281.svg",
  "https://static.wixstatic.com/shapes/d67a12_e8867e6413bc4ca3bf103ca27bdebc27.svg",
  "https://static.wixstatic.com/shapes/d67a12_154ac8119c4b4d8dbe969ac29d14141f.svg",
  "https://static.wixstatic.com/shapes/d67a12_b8c025c6c0cf4ac6b1e91c8e47490720.svg",
];

/* color classes to choose from (two different per card) */
const COLOR_CLASSES = ["t-blue","t-yellow","t-teal","t-dark","t-red","t-white"];

/* --- FIXED icon/color sets so we can SWAP children <-> art ONLY --- */
const CHILD_ICON_SETS = [
  { icons:[ICON_URLS[0],  ICON_URLS[1]],  colors:["t-blue","t-yellow"] },
  { icons:[ICON_URLS[2],  ICON_URLS[3]],  colors:["t-teal","t-dark"]  },
  { icons:[ICON_URLS[4],  ICON_URLS[5]],  colors:["t-red","t-white"]  },
];
const ART_ICON_SETS = [
  { icons:[ICON_URLS[6],  ICON_URLS[7]],  colors:["t-dark","t-teal"]  },
  { icons:[ICON_URLS[8],  ICON_URLS[9]],  colors:["t-yellow","t-red"] },
  { icons:[ICON_URLS[10], ICON_URLS[11]], colors:["t-blue","t-white"] },
];

/* pick two distinct items from an array (used for other groups only) */
function pickTwoDistinct(arr){
  const a = Math.floor(Math.random()*arr.length);
  let b = Math.floor(Math.random()*arr.length);
  if(b===a) b=(a+1)%arr.length;
  return [arr[a], arr[b]];
}

/* Render */
function renderGroup(name){
  const grid = document.querySelector(`[data-grid="${name}"]`);
  if(!grid) return;
  grid.innerHTML = data[name].map((c, idx)=>{
    let icon1, icon2, color1, color2;

    /* Swap logic: children get ART sets; art gets CHILD sets */
    if(name === "children"){
      const set = ART_ICON_SETS[idx % ART_ICON_SETS.length];
      [icon1, icon2] = set.icons; [color1, color2] = set.colors;
    }else if(name === "art"){
      const set = CHILD_ICON_SETS[idx % CHILD_ICON_SETS.length];
      [icon1, icon2] = set.icons; [color1, color2] = set.colors;
    }else{
      /* unchanged behavior for other groups: random icons/colors */
      [icon1, icon2] = pickTwoDistinct(ICON_URLS);
      [color1, color2] = pickTwoDistinct(COLOR_CLASSES);
    }

    const chips = c.chips.map(ch=>`<span class="chip">${ch}</span>`).join('');
    const price = c.price === 'ind.'
      ? `<div class="price"><span>ind.</span><span class="per">  tailored pricing</span></div>`
      : `<div class="price"><span>${currency}${c.price}</span><span class="per">  ${c.priceNote}</span></div>`;
    return `<article class="card">
      <a class="card-overlay" href="${c.link}" target="_blank" rel="noopener" aria-label="Open ${c.title}"></a>
      <div class="icon-row">
        <span class="icon ${color1}"><img alt="" src="${icon1}" loading="lazy"></span>
        <span class="icon anim ${color2}"><img alt="" src="${icon2}" loading="lazy"></span>
      </div>
      <div class="title">${c.title}</div>
      <div class="age-text">${c.age}</div>
      <p class="desc">${c.desc}</p>
      <div class="chips">${chips}</div>
      ${price}
    </article>`;
  }).join('');
}
["children","teenagers","adults","corporate","art"].forEach(renderGroup);

/* “Obscure” animation (15px drift + blur/fade) — RIGHT ICON ONLY */
function attachObscure(card){
  const MAX_SHIFT = 15, MAX_BLUR = 6, MIN_OPACITY = 0.35, MAX_DIST = 200;
  const icons = Array.from(card.querySelectorAll('.icon.anim')); /* animate only the right icon */
  if(!icons.length) return;

  const state = icons.map(()=>({tx:0,ty:0,blur:0,op:1,x:0,y:0,b:0,o:1}));
  let raf=null;

  function update(ev){
    const rect = card.getBoundingClientRect();
    const mx = ev.clientX - rect.left, my = ev.clientY - rect.top;
    icons.forEach((icon,i)=>{
      const r = icon.getBoundingClientRect();
      const cx = r.left - rect.left + r.width/2, cy = r.top - rect.top + r.height/2;
      const dx = mx - cx, dy = my - cy, dist = Math.hypot(dx,dy);
      const t = Math.min(dist/MAX_DIST,1), shift = MAX_SHIFT*t;
      const nx = dist ? dx/dist : 0, ny = dist ? dy/dist : 0;
      const s = state[i];
      s.tx = nx*shift; s.ty = ny*shift; s.blur = MAX_BLUR*t; s.op = 1 - (1-MIN_OPACITY)*t;
    });
    if(!raf) loop();
  }
  function reset(){ state.forEach(s=>{s.tx=0;s.ty=0;s.blur=0;s.op=1}); if(!raf) loop(); }

  function loop(){
    raf = requestAnimationFrame(()=>{
      let still=true, ease=0.18;
      state.forEach((s,i)=>{
        s.x += (s.tx - s.x)*ease; s.y += (s.ty - s.y)*ease;
        s.b += (s.blur - s.b)*ease; s.o += (s.op - s.o)*ease;
        const el = icons[i];
        el.style.transform = `translate3d(${s.x}px,${s.y}px,0)`;
        el.style.filter = `blur(${s.b}px)`; el.style.opacity = String(s.o);
        if(Math.abs(s.tx-s.x)>0.1 || Math.abs(s.ty-s.y)>0.1 || Math.abs(s.blur-s.b)>0.1 || Math.abs(s.op-s.o)>0.01) still=false;
      });
      if(!still) loop(); else raf=null;
    });
  }
  card.addEventListener('mousemove', update, {passive:true});
  card.addEventListener('mouseleave', reset);
}
function attachAllObscure(){ document.querySelectorAll('.card').forEach(attachObscure); }

/* Tabs */
function showMain(which){
  const en = which === 'en';
  document.getElementById('tab-en').setAttribute('aria-selected', en);
  document.getElementById('tab-art').setAttribute('aria-selected', !en);
  document.getElementById('panel-en').classList.toggle('hidden', !en);
  document.getElementById('panel-art').classList.toggle('hidden', en);
  document.getElementById('subtabs-en').classList.toggle('hidden', !en);
  attachAllObscure();
  LA_sendHeight();
}
function showSub(which){
  const ids = ['children','teenagers','adults','corporate'];
  ids.forEach(id=>{
    document.getElementById(`sub-${id}`).setAttribute('aria-selected', id===which);
    document.getElementById(`subpanel-${id}`).classList.toggle('hidden', id!==which);
  });
  attachAllObscure();
  LA_sendHeight();
}
document.getElementById('tab-en').addEventListener('click', ()=>showMain('en'));
document.getElementById('tab-art').addEventListener('click', ()=>showMain('art'));
['children','teenagers','adults','corporate'].forEach(id=>{
  document.getElementById(`sub-${id}`).addEventListener('click', ()=>showSub(id));
});

/* After initial render, bind animation */
window.addEventListener('load', attachAllObscure);

/* Auto-resize for Wix iframe */
(function () {
  function sendHeight() {
    requestAnimationFrame(() => {
      const h = Math.ceil(document.documentElement.scrollHeight);
      if (window.parent) {
        window.parent.postMessage({ type: 'LA_HEIGHT', height: h }, '*');
      }
    });
  }
  window.addEventListener('load', sendHeight);
  document.addEventListener('DOMContentLoaded', sendHeight);
  if (document.fonts && document.fonts.ready) document.fonts.ready.then(sendHeight);
  new ResizeObserver(sendHeight).observe(document.body);
  new MutationObserver(sendHeight).observe(document.body, { subtree: true, childList: true, attributes: true, characterData: true });
  window.addEventListener('resize', sendHeight);
  setTimeout(sendHeight, 0);
  window.LA_sendHeight = sendHeight;
})();
</script>
</body>
</html>

